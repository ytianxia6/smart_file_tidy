# Interactive æ¨¡å¼ä¿®å¤è¯´æ˜ âœ…

## ğŸ¯ é—®é¢˜æè¿°

ç”¨æˆ·å‘ç°ï¼š
- âŒ `smart-tidy interactive` ä¸ä¼šè¿›è¡Œæ“ä½œï¼ˆåªæ˜¾ç¤º"æ²¡æœ‰éœ€è¦æ‰§è¡Œçš„æ“ä½œ"ï¼‰
- âœ… `smart-tidy agent` å¯ä»¥æ­£å¸¸æ‰§è¡Œæ“ä½œ

## ğŸ” æ ¹æœ¬åŸå› 

ä¸¤ç§æ¨¡å¼ä½¿ç”¨äº†ä¸åŒçš„åç«¯å®ç°ï¼š

### æ—§çš„ interactive æ¨¡å¼ï¼ˆå·²ä¿®å¤å‰ï¼‰
```python
# ä½¿ç”¨ä¼ ç»Ÿåˆ†ç±»å™¨
controller = Controller(config, ai_provider=provider)  # use_agent=False
operations = controller.generate_plan(files, request)  # åªç”Ÿæˆè®¡åˆ’
```

**é—®é¢˜**ï¼š
- `generate_plan()` ä½¿ç”¨æ—§çš„ AI adapter
- åªè¿”å› `Operation` å¯¹è±¡åˆ—è¡¨ï¼ˆè®¡åˆ’ï¼‰
- ä¸ä¼šçœŸæ­£æ‰§è¡Œæ–‡ä»¶æ“ä½œ
- éœ€è¦æ‰‹åŠ¨è°ƒç”¨ `execute_operations()` æ‰§è¡Œ

### agent æ¨¡å¼ï¼ˆæ­£å¸¸å·¥ä½œï¼‰
```python
# ä½¿ç”¨ LangChain Agent
controller = Controller(config, ai_provider=provider, use_agent=True)
result = controller.organize_with_agent(directory, request)  # è‡ªåŠ¨æ‰§è¡Œ
```

**ä¼˜åŠ¿**ï¼š
- ä½¿ç”¨ LangChain Agent å’Œ ReAct æ¨¡å¼
- Agent è‡ªåŠ¨è°ƒç”¨å·¥å…·ï¼ˆfile_scanner, file_analyzer, file_operatorï¼‰
- å·¥å…·ä¼šçœŸæ­£æ‰§è¡Œæ–‡ä»¶æ“ä½œ
- ä¸€æ­¥åˆ°ä½ï¼Œè‡ªåŠ¨å®Œæˆæ•´ç†

## âœ… è§£å†³æ–¹æ¡ˆ

å°† `interactive` æ¨¡å¼æ”¹ä¸ºä½¿ç”¨ Agent åç«¯ï¼Œä¸ `agent` æ¨¡å¼ä¿æŒä¸€è‡´ã€‚

### ä¿®æ”¹å†…å®¹

**æ–‡ä»¶**: `src/cli/commands.py`

**å…³é”®ä¿®æ”¹**:

1. **åˆå§‹åŒ– Controller æ—¶å¯ç”¨ Agent**
```python
# æ—§ä»£ç 
controller = Controller(config, ai_provider=provider)

# æ–°ä»£ç 
controller = Controller(config, ai_provider=provider, use_agent=True)
```

2. **ä½¿ç”¨ organize_with_agent æ›¿ä»£ generate_plan**
```python
# æ—§ä»£ç 
operations = controller.generate_plan(files, request)
if len(operations) == 0:
    console.print("[yellow]æ²¡æœ‰éœ€è¦æ‰§è¡Œçš„æ“ä½œ[/yellow]\n")
    continue
# æ˜¾ç¤ºæ“ä½œé¢„è§ˆ...
# æ‰§è¡Œæ“ä½œ...

# æ–°ä»£ç 
result = controller.organize_with_agent(directory, request)
if result.get('success'):
    console.print("\n[green]âœ“ å®Œæˆï¼[/green]\n")
    # æ˜¾ç¤ºAgentæŠ¥å‘Š...
```

3. **ç®€åŒ–äº¤äº’æµç¨‹**
- ç§»é™¤äº†"æ“ä½œé¢„è§ˆè¡¨æ ¼"ï¼ˆå› ä¸º Agent ä¼šè‡ªåŠ¨æ‰§è¡Œï¼‰
- ç§»é™¤äº†"æ˜¯å¦æ‰§è¡Œ"çš„ç¡®è®¤ï¼ˆAgent ç›´æ¥æ‰§è¡Œï¼‰
- æ·»åŠ äº† Agent æŠ¥å‘Šè¾“å‡º
- æ·»åŠ äº†"æ˜¯å¦ç»§ç»­æ•´ç†"çš„è¯¢é—®

## ğŸ“Š ä¿®æ”¹å¯¹æ¯”

| ç‰¹æ€§ | æ—§ interactive | æ–° interactive | agent å‘½ä»¤ |
|------|---------------|---------------|-----------|
| åç«¯ | AI Adapter | LangChain Agent | LangChain Agent |
| æ‰«ææ–‡ä»¶ | âœ… | âœ… | âœ… |
| åˆ†ææ–‡ä»¶ | âŒ | âœ… | âœ… |
| æ‰§è¡Œæ“ä½œ | âŒ æ‰‹åŠ¨ | âœ… è‡ªåŠ¨ | âœ… è‡ªåŠ¨ |
| æ“ä½œé¢„è§ˆ | âœ… | âŒ | âŒ |
| å¤šè½®äº¤äº’ | âœ… | âœ… | âŒ |
| ReAct æ¨¡å¼ | âŒ | âœ… | âœ… |

## ğŸ¯ ç°åœ¨çš„è¡Œä¸º

### interactive æ¨¡å¼ï¼ˆä¿®å¤åï¼‰

```bash
uv run smart-tidy interactive ./test_files
```

**æµç¨‹**:
1. æ‰«æç›®å½•ï¼Œå‘ç°æ–‡ä»¶
2. è¾“å…¥æ•´ç†éœ€æ±‚
3. Agent è‡ªåŠ¨åˆ†æ â†’ è‡ªåŠ¨æ‰§è¡Œ â†’ æ˜¾ç¤ºæŠ¥å‘Š
4. è¯¢é—®æ˜¯å¦ç»§ç»­ï¼ˆå¯ä»¥å¤šè½®ï¼‰
5. è¾“å…¥ 'q' é€€å‡º

**ç‰¹ç‚¹**:
- âœ… è‡ªåŠ¨æ‰§è¡Œæ“ä½œ
- âœ… æ”¯æŒå¤šè½®äº¤äº’
- âœ… ä½¿ç”¨ ReAct æ¨¡å¼
- âœ… çœŸæ­£çš„æ–‡ä»¶æ“ä½œ

### agent æ¨¡å¼ï¼ˆä¿æŒä¸å˜ï¼‰

```bash
uv run smart-tidy agent ./test_files --request "æ•´ç†è¿™äº›æ–‡ä»¶"
```

**æµç¨‹**:
1. ä¸€æ¬¡æ€§æ‰§è¡ŒæŒ‡å®šçš„è¯·æ±‚
2. æ˜¾ç¤º Agent æŠ¥å‘Š
3. å®Œæˆåé€€å‡º

**ç‰¹ç‚¹**:
- âœ… è‡ªåŠ¨æ‰§è¡Œæ“ä½œ
- âŒ å•æ¬¡æ‰§è¡Œï¼ˆä¸å¾ªç¯ï¼‰
- âœ… ä½¿ç”¨ ReAct æ¨¡å¼
- âœ… çœŸæ­£çš„æ–‡ä»¶æ“ä½œ

## ğŸ”„ ä¸¤ç§æ¨¡å¼çš„åŒºåˆ«

| åœºæ™¯ | æ¨èæ¨¡å¼ |
|------|---------|
| ä¸€æ¬¡æ€§æ•´ç†ä»»åŠ¡ | `agent` |
| æ¢ç´¢æ€§æ•´ç†ï¼Œéœ€è¦å¤šæ¬¡å°è¯• | `interactive` |
| è‡ªåŠ¨åŒ–è„šæœ¬ | `agent` |
| æ‰‹åŠ¨è°ƒæ•´å’Œè¿­ä»£ | `interactive` |

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯• 1: Interactive æ¨¡å¼

```bash
uv run smart-tidy interactive ./test_files
```

**é¢„æœŸè¾“å‡º**:
```
âœ“ å‘ç° 8 ä¸ªæ–‡ä»¶

äº¤äº’å¼æ•´ç†æ¨¡å¼
è¾“å…¥æ•´ç†éœ€æ±‚ï¼ŒAgentå°†è‡ªåŠ¨åˆ†æå¹¶æ‰§è¡Œæ“ä½œ

è¯·æè¿°æ‚¨çš„æ•´ç†éœ€æ±‚: æ•´ç†è¿™äº›æ–‡ä»¶

Agentæ­£åœ¨å·¥ä½œä¸­...

âœ“ å®Œæˆï¼

AgentæŠ¥å‘Šï¼š
[æ•´ç†æŠ¥å‘Šå†…å®¹]

å½“å‰è¿˜æœ‰ X ä¸ªæ–‡ä»¶

æ˜¯å¦ç»§ç»­æ•´ç†ï¼Ÿ
```

### æµ‹è¯• 2: Agent æ¨¡å¼

```bash
uv run smart-tidy agent ./test_files --request "æ•´ç†è®ºæ–‡"
```

**é¢„æœŸè¾“å‡º**:
```
ä½¿ç”¨AI Provider: custom
ç›®æ ‡ç›®å½•: ./test_files
ç”¨æˆ·éœ€æ±‚: æ•´ç†è®ºæ–‡

æ˜¯å¦å¼€å§‹æ‰§è¡Œï¼Ÿ [Y/n]: y

Agentæ­£åœ¨å·¥ä½œä¸­...

âœ“ æ•´ç†å®Œæˆï¼

AgentæŠ¥å‘Šï¼š
[æ•´ç†æŠ¥å‘Šå†…å®¹]

æ‰§è¡Œæ­¥éª¤æ•°ï¼š15
```

## âœ¨ ä¼˜åŠ¿

1. **ç»Ÿä¸€ä½“éªŒ**: ä¸¤ç§æ¨¡å¼éƒ½ä½¿ç”¨ Agentï¼Œè¡Œä¸ºä¸€è‡´
2. **çœŸæ­£æ‰§è¡Œ**: ä¸å†åªæ˜¯"å»ºè®®"ï¼Œè€Œæ˜¯çœŸæ­£æ“ä½œæ–‡ä»¶
3. **æ™ºèƒ½å†³ç­–**: Agent å¯ä»¥è‡ªä¸»åˆ†æå’Œé€‰æ‹©æ“ä½œ
4. **é”™è¯¯å¤„ç†**: Agent è‡ªå¸¦å®Œæ•´çš„å¼‚å¸¸å¤„ç†

## ğŸ“ ç›¸å…³æ–‡ä»¶

- `src/cli/commands.py` - CLI å‘½ä»¤å®ç°ï¼ˆå·²ä¿®æ”¹ï¼‰
- `src/core/controller.py` - Controller å®ç°
- `src/langchain_integration/agent.py` - Agent æ ¸å¿ƒé€»è¾‘
- `src/langchain_integration/tools/` - å·¥å…·å®ç°

## ğŸ‰ æ€»ç»“

**é—®é¢˜å·²è§£å†³ï¼**

- âœ… `interactive` æ¨¡å¼ç°åœ¨ä½¿ç”¨ Agent åç«¯
- âœ… ä¼šçœŸæ­£æ‰§è¡Œæ–‡ä»¶æ“ä½œ
- âœ… ä¸ `agent` æ¨¡å¼ä¿æŒä¸€è‡´çš„è¡Œä¸º
- âœ… ä¿ç•™äº†å¤šè½®äº¤äº’çš„ä¼˜åŠ¿

**ç°åœ¨ä¸¤ç§æ¨¡å¼éƒ½å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼**

---

**ä¿®å¤æ—¶é—´**: 2026-01-26
**çŠ¶æ€**: âœ… å·²ä¿®å¤
**æµ‹è¯•çŠ¶æ€**: å¾…ç”¨æˆ·éªŒè¯
